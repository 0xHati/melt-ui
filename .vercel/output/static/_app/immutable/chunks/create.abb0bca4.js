import{u as B,g as G,a as H}from"./check-circle.1739929e.js";import{d as U,b as w,c as z,e as X,a as D,n as j}from"./callbacks.6723c42c.js";import{b as M,a as u}from"./index.a1398546.js";import{s as K}from"./style.928edf99.js";import{k as o}from"./create.6a8ca084.js";import{w as s}from"./index.cb808db3.js";import{K as q,D as J}from"./scheduler.2943ef39.js";import{c as Q,s as V,h as Z,a as $,g as ee,b as te,d as c}from"./create.7bb1f0d9.js";const re=[o.ARROW_DOWN,o.PAGE_UP,o.HOME],ne=[o.ARROW_UP,o.PAGE_DOWN,o.END],se=[...re,...ne],oe={arrowSize:8,positioning:{placement:"bottom-start"},preventScroll:!0},{name:R,selector:A}=z("context-menu");function ge(y){const P={...oe,...y},h=s(P),r=s(!1),p=s(null),v=s(null),T=s(null),{item:_,checkboxItem:I,arrow:F,createSubMenu:O,createMenuRadioGroup:N,rootIds:i,separator:W,handleTypeaheadSearch:C}=Q({rootOpen:r,rootActiveTrigger:p,rootOptions:h,nextFocusable:v,prevFocusable:T,disableFocusFirstItem:!0,disableTriggerRefocus:!0,selector:"context-menu"}),S=s({x:0,y:0}),L=U([S],([t])=>({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...t})})),n=s(0),Y=w(R(),{stores:r,returned:t=>({role:"menu",hidden:t?void 0:!0,style:K({display:t?void 0:"none"}),id:i.menu,"aria-labelledby":i.trigger,"data-state":t?"open":"closed",tabindex:-1}),action:t=>{let a=j;const x=X([r,p,h],([e,f,l])=>{a(),e&&f&&q().then(()=>{V(t,A);const k=J(L),d=B(t,{anchorElement:k,open:r,options:{floating:l.positioning,clickOutside:{handler:m=>{if(m.defaultPrevented)return;const g=m.target;if(M(g)){if(g.id===i.trigger&&m.button===0){r.set(!1);return}g.id!==i.trigger&&!g.closest(A())&&r.set(!1)}}}}});d&&d.destroy&&(a=d.destroy)})}),E=D(u(t,"keydown",e=>{const f=e.target;if(!M(f))return;const l=e.currentTarget;if(!M(l)||!(f.closest("[role='menu']")===l))return;if(se.includes(e.key)&&Z(e),e.key===o.TAB){e.preventDefault(),p.set(null),r.set(!1),$(e,v,T);return}const d=e.key.length===1;!(e.ctrlKey||e.altKey||e.metaKey)&&d&&C(e.key,ee(l))}));return{destroy(){x(),E(),a()}}}});return{trigger:w(R("trigger"),{stores:r,returned:t=>({"aria-controls":i.menu,"aria-expanded":t,"data-state":t?"open":"closed",id:i.trigger,style:K({WebkitTouchCallout:"none"})}),action:t=>{te(t);const a=e=>{S.set({x:e.clientX,y:e.clientY}),v.set(G(t)),T.set(H(t)),p.set(t),r.set(!0)},x=()=>{c(n)},E=D(u(t,"contextmenu",e=>{c(n),a(e),e.preventDefault()}),u(t,"pointerdown",e=>{b(e)&&(c(n),n.set(window.setTimeout(()=>a(e),700)))}),u(t,"pointermove",e=>{b(e)&&c(n)}),u(t,"pointercancel",e=>{b(e)&&c(n)}),u(t,"pointerup",e=>{b(e)&&c(n)}));return{destroy(){x(),E()}}}}),menu:Y,open:r,item:_,checkboxItem:I,arrow:F,options:h,createSubMenu:O,createMenuRadioGroup:N,separator:W}}function b(y){return y.pointerType!=="mouse"}export{ge as c};
