import{c as Ot,h as I,u as dt,g as ft,a as mt}from"./check-circle.1739929e.js";import{c as _t,d as Lt,b as K,e as X,a as N,n as gt}from"./callbacks.6723c42c.js";import{i as U,b as n,a as f,c as O}from"./index.a1398546.js";import{g as G,r as Ft,s as pt}from"./portal.080fdab2.js";import{s as J}from"./style.928edf99.js";import{k as y}from"./create.6a8ca084.js";import{D as h,L as Wt,K as bt}from"./scheduler.2943ef39.js";import{w as M,d as Bt}from"./index.cb808db3.js";import{c as Ct}from"./Balancer.98226975.js";const Z=[y.ENTER,y.SPACE],Nt=[y.ARROW_DOWN,y.PAGE_UP,y.HOME],zt=[y.ARROW_UP,y.PAGE_DOWN,y.END],vt=[...Nt,...zt],Xt={ltr:[...Z,y.ARROW_RIGHT],rtl:[...Z,y.ARROW_LEFT]},Yt={ltr:[y.ARROW_LEFT],rtl:[y.ARROW_RIGHT]},Ht={arrowSize:8,positioning:{placement:"bottom"},preventScroll:!0};function ne(l){const{name:m,selector:w}=_t(l.selector),A=l.rootOptions,v=l.rootOpen,k=l.rootActiveTrigger,P=l.nextFocusable,W=l.prevFocusable,S=M(!1),V=M(0),_=M(null),$=M("right"),ht=Lt([$,_],([t,a])=>c=>t===(a==null?void 0:a.side)&&Vt(c,a==null?void 0:a.area)),{typed:ot,handleTypeaheadSearch:tt}=Ot(),B={menu:G(),trigger:G()},Et=K(m(),{stores:[v],returned:([t])=>({role:"menu",hidden:t?void 0:!0,style:J({display:t?void 0:"none"}),id:B.menu,"aria-labelledby":B.trigger,"data-state":t?"open":"closed",tabindex:-1}),action:t=>{let a=gt;const c=X([v,k,A],([e,u,r])=>{a(),e&&u&&bt().then(()=>{H(t,w);const d=dt(t,{anchorElement:u,open:v,options:{floating:r.positioning}});d&&d.destroy&&(a=d.destroy)})}),s=N(f(t,"keydown",e=>{const u=e.target;if(!n(u))return;const r=e.currentTarget;if(!n(r)||!(u.closest(w())===r))return;if(vt.includes(e.key)&&yt(e),e.key===y.TAB){e.preventDefault(),k.set(null),v.set(!1),Ut(e,P,W);return}const x=e.key.length===1;!(e.ctrlKey||e.altKey||e.metaKey)&&x&&tt(e.key,z(r))}));return{destroy(){c(),s(),a()}}}}),Tt=K(m("trigger"),{stores:[v],returned:([t])=>({"aria-controls":B.menu,"aria-expanded":t,"data-state":t?"open":"closed",id:B.trigger}),action:t=>(Q(t),{destroy:N(f(t,"pointerdown",c=>{const s=h(v),e=c.currentTarget;n(e)&&(v.update(u=>{const r=!u;return r?(P.set(ft(e)),W.set(mt(e)),k.set(e)):k.set(null),r}),s||c.preventDefault())}),f(t,"keydown",c=>{const s=c.currentTarget;if(n(s)&&(Z.includes(c.key)||c.key===y.ARROW_DOWN)){c.key===y.ARROW_DOWN&&c.preventDefault(),v.update(x=>{const L=!x;return L?(P.set(ft(s)),W.set(mt(s)),k.set(s)):k.set(null),L});const e=s.getAttribute("aria-controls");if(!e)return;const u=document.getElementById(e);if(!n(u))return;const r=z(u);if(!r.length)return;const d=r[0];if(!n(d))return;I(d)}}))})}),wt=K(m("arrow"),{stores:A,returned:t=>({"data-arrow":!0,style:J({position:"absolute",width:`var(--arrow-size, ${t.arrowSize}px)`,height:`var(--arrow-size, ${t.arrowSize}px)`})})}),kt=K(m("item"),{returned:()=>({role:"menuitem",tabindex:-1,"data-orientation":"vertical"}),action:(t,a={})=>{const{onSelect:c}=a;return H(t,w),Q(t),{destroy:N(f(t,"pointerdown",e=>{const u=e.currentTarget;if(n(u)&&O(u)){e.preventDefault();return}}),f(t,"click",e=>{const u=e.currentTarget;if(n(u)){if(O(u)){e.preventDefault();return}if(e.defaultPrevented){if(!n(u))return;I(u);return}c==null||c(e),!e.defaultPrevented&&v.set(!1)}}),f(t,"keydown",e=>{nt(e)}),f(t,"pointermove",e=>{const u=e.currentTarget;if(n(u)){if(O(u)){j(e);return}et(e)}}),f(t,"pointerleave",e=>{rt(e)}),f(t,"focusin",e=>{const u=e.currentTarget;n(u)&&u.setAttribute("data-highlighted","")}),f(t,"focusout",e=>{const u=e.currentTarget;n(u)&&u.removeAttribute("data-highlighted")}))}}}),At={checked:M(!1)},Dt=K(m("checkbox-item"),{returned:()=>({role:"menuitemcheckbox",tabindex:-1,"data-orientation":"vertical"}),action:(t,a)=>{H(t,w),Q(t);const{checked:c,onSelect:s}={...At,...a},e=h(c);return t.setAttribute("aria-checked",it(e)?"mixed":String(e)),t.setAttribute("data-state",Kt(e)),{destroy:N(f(t,"pointerdown",r=>{const d=r.currentTarget;if(n(d)&&O(d)){r.preventDefault();return}}),f(t,"click",r=>{const d=r.currentTarget;if(n(d)){if(O(d)){r.preventDefault();return}if(r.defaultPrevented){if(!n(d))return;I(d);return}s==null||s(r),!r.defaultPrevented&&(c.update(x=>it(x)?!0:!x),v.set(!1))}}),f(t,"keydown",r=>{nt(r)}),f(t,"pointermove",r=>{const d=r.currentTarget;if(n(d)){if(O(d)){j(r);return}et(r)}}),f(t,"pointerleave",r=>{rt(r)}),f(t,"focusin",r=>{const d=r.currentTarget;n(d)&&d.setAttribute("data-highlighted","")}),f(t,"focusout",r=>{const d=r.currentTarget;n(d)&&d.removeAttribute("data-highlighted")}))}}}),It=(t={})=>{const a=M(t.value??null),c=K(m("radio-group"),{returned:()=>({role:"group"})}),s={disabled:!1},e=K(m("radio-item"),{stores:[a],returned:([r])=>d=>{const{value:x,disabled:L}={...s,...d},p=r===x;return{disabled:L,role:"menuitemradio","data-state":p?"checked":"unchecked","aria-checked":p,"data-disabled":L?"":void 0,"data-value":x,"data-orientation":"vertical",tabindex:-1}},action:(r,d={})=>{H(r,w);const{onSelect:x}=d;return{destroy:N(f(r,"pointerdown",p=>{const o=p.currentTarget;if(!n(o))return;const D=r.dataset.value;if(r.dataset.disabled||D===void 0){p.preventDefault();return}}),f(r,"click",p=>{const o=p.currentTarget;if(!n(o))return;const D=r.dataset.value;if(r.dataset.disabled||D===void 0){p.preventDefault();return}if(p.defaultPrevented){if(!n(o))return;I(o);return}x==null||x(p),!p.defaultPrevented&&(a.set(D),v.set(!1))}),f(r,"keydown",p=>{nt(p)}),f(r,"pointermove",p=>{const o=p.currentTarget;if(!n(o))return;const D=r.dataset.value;if(r.dataset.disabled||D===void 0){j(p);return}et(p)}),f(r,"pointerleave",p=>{rt(p)}),f(r,"focusin",p=>{const o=p.currentTarget;n(o)&&o.setAttribute("data-highlighted","")}),f(r,"focusout",p=>{const o=p.currentTarget;n(o)&&o.removeAttribute("data-highlighted")}))}}}),u=Bt(a,r=>d=>r===d);return{radioGroup:c,radioItem:e,isChecked:u,value:a}},{root:xt}=Ct({orientation:"horizontal"}),Pt={...Ht,disabled:!1,positioning:{placement:"right-start",gutter:8}},St=t=>{const a={...Pt,...t},c=M(a),s=M(!1),e=M(null),u=M(null),r=M(0),d={menu:G(),trigger:G()},x=K(m("submenu"),{stores:[s],returned:([o])=>({role:"menu",hidden:o?void 0:!0,style:J({display:o?void 0:"none"}),id:d.menu,"aria-labelledby":d.trigger,"data-state":o?"open":"closed",tabindex:-1}),action:o=>{let D=gt;const F=X([s,e,c],([i,g,T])=>{D(),i&&g&&bt().then(()=>{const E=ct(g),R=dt(o,{anchorElement:g,open:s,options:{floating:T.positioning,portal:n(E)?E:void 0,clickOutside:null,focusTrap:null}});R&&R.destroy&&(D=R.destroy)})}),b=N(f(o,"keydown",i=>{if(i.key===y.ESCAPE)return;const g=i.target;if(!n(g))return;const T=i.currentTarget;if(!n(T)||!(g.closest('[role="menu"]')===T))return;if(vt.includes(i.key)){i.stopImmediatePropagation(),yt(i);return}const R=Yt.ltr.includes(i.key),C=i.ctrlKey||i.altKey||i.metaKey,q=i.key.length===1;if(R){const lt=h(e);i.preventDefault(),s.update(()=>(lt&&I(lt),e.set(null),!1));return}if(i.key===y.TAB){i.preventDefault();return}!C&&q&&tt(i.key,z(T))}),f(o,"pointermove",i=>{Rt(i)}),f(o,"focusout",i=>{const g=h(e);if(h(S)){const T=i.target;if(!n(T))return;const E=document.getElementById(d.menu);if(!n(E))return;!(E!=null&&E.contains(T))&&T!==g&&(s.set(!1),e.set(null))}else{const T=i.currentTarget;if(!n(T))return;const E=i.relatedTarget;if(!n(E))return;!T.contains(E)&&E!==g&&(s.set(!1),e.set(null))}}));return{destroy(){F(),D(),b()}}}}),L=K(m("subtrigger"),{stores:[s,c],returned:([o,D])=>({role:"menuitem",id:d.trigger,tabindex:-1,"aria-controls":d.menu,"aria-expanded":o,"data-state":o?"open":"closed","data-disabled":D.disabled?"":void 0,"aria-haspopop":"menu"}),action:o=>{H(o,w),Q(o);const D=()=>{ut(u),window.clearTimeout(h(r)),_.set(null)},F=N(f(o,"click",b=>{const i=b.currentTarget;n(i)&&(O(i)||b.defaultPrevented||(I(i),h(s)||s.update(g=>g||(e.set(i),!g))))}),f(o,"keydown",b=>{const i=h(ot),g=b.currentTarget;if(!(!n(g)||O(g)||i.length>0&&b.key===y.SPACE)&&Xt.ltr.includes(b.key)){if(!h(s)){g.click(),b.preventDefault();return}const E=g.getAttribute("aria-controls");if(!E)return;const R=document.getElementById(E);if(!n(R))return;const C=z(R)[0];if(!n(C))return;I(C)}}),f(o,"pointermove",b=>{if(!Y(b)||(at(b),b.defaultPrevented))return;const i=b.currentTarget;if(!n(i))return;I(i);const g=h(u);!h(s)&&!g&&!O(i)&&u.set(window.setTimeout(()=>{s.update(()=>(e.set(i),!0)),ut(u)},100))}),f(o,"pointerleave",b=>{if(!Y(b))return;ut(u);const i=document.getElementById(d.menu),g=i==null?void 0:i.getBoundingClientRect();if(g){const T=i==null?void 0:i.dataset.side,E=T==="right",R=E?-5:5,C=g[E?"left":"right"],q=g[E?"right":"left"];_.set({area:[{x:b.clientX+R,y:b.clientY},{x:C,y:g.top},{x:q,y:g.top},{x:q,y:g.bottom},{x:C,y:g.bottom}],side:T}),window.clearTimeout(h(r)),r.set(window.setTimeout(()=>{_.set(null)},300))}else{if(Mt(b),b.defaultPrevented)return;_.set(null)}}),f(o,"focusout",b=>{const i=b.currentTarget;if(!n(i)||!n(i))return;i.removeAttribute("data-highlighted");const g=b.relatedTarget;if(!n(g))return;const T=i.getAttribute("aria-controls");if(!T)return;const E=document.getElementById(T);n(E)&&!E.contains(g)&&(e.set(null),s.set(!1))}),f(o,"focusin",b=>{const i=b.currentTarget;n(i)&&i.setAttribute("data-highlighted","")}));return{destroy(){D(),F()}}}}),p=K(m("subarrow"),{stores:c,returned:o=>({"data-arrow":!0,style:J({position:"absolute",width:`var(--arrow-size, ${o.arrowSize}px)`,height:`var(--arrow-size, ${o.arrowSize}px)`})})});return X([v],([o])=>{o||(e.set(null),s.set(!1))}),X([_],([o])=>{U&&(o||window.clearTimeout(h(r)))}),X([s],([o])=>{U&&pt(1).then(()=>{const D=document.getElementById(d.menu);if(n(D)&&o&&h(S)){const F=z(D);h(S)&&n(F[0])&&I(F[0])}})}),{subTrigger:L,subMenu:x,subOpen:s,subArrow:p,subOptions:c}};X([v,k],([t,a])=>{if(!U)return;const c=[],s=h(A);return t&&s.preventScroll&&c.push(Ft()),!t&&a&&I(a),pt(1).then(()=>{const e=document.getElementById(B.menu);if(n(e)&&t&&h(S)){if(l.disableFocusFirstItem){I(e);return}const u=z(e);n(u[0])&&I(u[0])}else if(a)I(a);else{if(l.disableTriggerRefocus)return;const u=document.getElementById(B.trigger);n(u)&&I(u)}}),()=>{c.forEach(e=>e())}}),Wt(()=>{const t=()=>S.set(!1),a=()=>{S.set(!0),document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})};document.addEventListener("keydown",a,{capture:!0});const c=s=>{if(s.key===y.ESCAPE){v.set(!1);return}};return document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",a,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0}),document.removeEventListener("keydown",c)}});function at(t){st(t)&&t.preventDefault()}function j(t){if(st(t))return;const a=t.target;if(!n(a))return;const c=ct(a);n(c)&&I(c)}function Mt(t){st(t)&&t.preventDefault()}function Rt(t){if(!Y(t))return;const a=t.target;if(!n(a))return;const c=t.currentTarget;if(!n(c))return;const s=h(V),e=s!==t.clientX;if(c.contains(a)&&e){const u=t.clientX>s?"right":"left";$.set(u),V.set(t.clientX)}}function et(t){if(Y(t)&&(at(t),!t.defaultPrevented)){const a=t.currentTarget;if(!n(a))return;I(a)}}function rt(t){Y(t)&&j(t)}function nt(t){if(h(ot).length>0&&t.key===y.SPACE){t.preventDefault();return}if(Z.includes(t.key)){t.preventDefault();const s=t.currentTarget;if(!n(s))return;s.click()}}function it(t){return t==="indeterminate"}function Kt(t){return it(t)?"indeterminate":t?"checked":"unchecked"}function st(t){return h(ht)(t)}function ct(t){return t.closest('[role="menu"]')}return{trigger:Tt,menu:Et,open:v,item:kt,checkboxItem:Dt,arrow:wt,options:A,createSubMenu:St,createMenuRadioGroup:It,separator:xt,rootIds:B,handleTypeaheadSearch:tt}}function Ut(l,m,w){if(l.shiftKey){const A=h(w);A&&(l.preventDefault(),A.focus(),w.set(null))}else{const A=h(m);A&&(l.preventDefault(),A.focus(),m.set(null))}}function z(l){return Array.from(l.querySelectorAll(`[data-melt-menu-id="${l.id}"]`))}function Q(l){U&&n(l)&&O(l)&&(l.setAttribute("data-disabled",""),l.setAttribute("aria-disabled","true"))}function ut(l){if(!U)return;const m=h(l);m&&(window.clearTimeout(m),l.set(null))}function Y(l){return l.pointerType==="mouse"}function H(l,m){if(!l)return;const w=l.closest(`${m()}, ${m("submenu")}`);n(w)&&l.setAttribute("data-melt-menu-id",w.id)}function yt(l){l.preventDefault();const m=document.activeElement;if(!n(m))return;const w=l.currentTarget;if(!n(w))return;const A=z(w);if(!A.length)return;const v=A.filter(S=>!(S.hasAttribute("data-disabled")||S.getAttribute("disabled")==="true")),k=v.indexOf(m);let P;switch(l.key){case y.ARROW_DOWN:P=k<v.length-1?k+1:k;break;case y.ARROW_UP:P=k>0?k-1:0;break;case y.HOME:P=0;break;case y.END:P=v.length-1;break;default:return}const W=v[P];I(W)}function Vt(l,m){if(!m)return!1;const w={x:l.clientX,y:l.clientY};return jt(w,m)}function jt(l,m){const{x:w,y:A}=l;let v=!1;for(let k=0,P=m.length-1;k<m.length;P=k++){const W=m[k].x,S=m[k].y,V=m[P].x,_=m[P].y;S>A!=_>A&&w<(V-W)*(A-S)/(_-S)+W&&(v=!v)}return v}export{vt as F,Z as S,Ut as a,Q as b,ne as c,ut as d,z as g,yt as h,H as s};
