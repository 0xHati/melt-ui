import{t as H,e as N,g as T}from"./callbacks.6723c42c.js";import{a as S,i as F}from"./index.a1398546.js";import{o as U,k as m}from"./create.6a8ca084.js";import{s as z}from"./style.928edf99.js";import{g as X}from"./portal.080fdab2.js";import{w as x,d as A}from"./index.cb808db3.js";import{D as y}from"./scheduler.2943ef39.js";const V={value:[],min:0,max:100,step:1,orientation:"horizontal",disabled:!1},Q=(C=V)=>{const k={...V,...C},p=x(U(k,"value")),E=x(k.value),O=x(!1),L=x(0),D=x(null),W={root:X()},M=A(p,n=>({disabled:n.disabled,"data-orientation":n.orientation,style:"touch-action: none;","data-melt-id":W.root})),_=A(p,n=>s=>{const o=(s-n.min)/(n.max-n.min)*100;return Math.abs(o)}),I=A([E,p,_],([n,s,o])=>{const r=n.length>1?o(Math.min(...n)??0):0,l=100-o(Math.max(...n)??0),c=s.orientation==="horizontal"?{left:`${r}%`,right:`${l}%`}:{top:`${r}%`,bottom:`${l}%`};return{style:z({position:"absolute",...c})}}),h=(n,s)=>{E.update(o=>{if(!o)return[n];const r=s===0;return!(s===o.length-1)&&n>o[s+1]?o[s]=o[s+1]:!r&&n<o[s-1]?o[s]=o[s-1]:o[s]=n,o.map(Math.abs)})},B=()=>{const n=T(W.root);return n?Array.from(n.querySelectorAll('[data-melt-part="thumb"]')).filter(Boolean):null},P={...H([E,p,_],([n,s,o])=>{let r=-1;return()=>{r++;const{min:l,max:c,disabled:v}=s;y(L)<n.length&&L.update(d=>d+1);const t=`${o(n[r])}%`;return{role:"slider","aria-label":"Volume","aria-valuemin":l,"aria-valuemax":c,"aria-valuenow":n[r],"data-melt-part":"thumb",style:z({position:"absolute",...s.orientation==="horizontal"?{left:t,translate:"-50% 0"}:{top:t,translate:"0 -50%`"}}),tabindex:v?-1:0}}}),action:n=>({destroy:S(n,"keydown",o=>{const r=y(p),l=r.min,c=r.max;if(r.disabled)return;const v=o.currentTarget,g=B();if(!(g!=null&&g.length))return;const t=g.indexOf(v);if(L.set(t),![m.ARROW_LEFT,m.ARROW_RIGHT,m.ARROW_UP,m.ARROW_DOWN,m.HOME,m.END].includes(o.key))return;o.preventDefault();const d=r.step,i=y(E);switch(o.key){case m.HOME:{h(l,t);break}case m.END:{h(c,t);break}case m.ARROW_LEFT:{if(i[t]>l&&r.orientation==="horizontal"){const e=i[t]-d;h(e,t)}break}case m.ARROW_RIGHT:{if(i[t]<c&&r.orientation==="horizontal"){const e=i[t]+d;h(e,t)}break}case m.ARROW_UP:{if(i[t]>l&&r.orientation==="vertical"){const e=i[t]-d;h(e,t)}else if(i[t]<c){const e=i[t]+d;h(e,t)}break}case m.ARROW_DOWN:{if(i[t]<c&&r.orientation==="vertical"){const e=i[t]+d;h(e,t)}else if(i[t]>l){const e=i[t]-d;h(e,t)}break}}})})};return N([M,p],([n,s])=>{const{min:o,max:r,disabled:l}=s;if(!F||l)return;const c=(i,e,a,u)=>{const f=(i-a)/(u-a),b=Math.round(f*(r-o)+o);if(b<o||b>r)return;const R=s.step,w=Math.round(b/R)*R;h(w,e)},v=i=>{const e=B();if(!e)return;e.forEach(b=>b==null?void 0:b.blur());const a=e.map(b=>{if(s.orientation==="horizontal"){const{left:R,right:w}=b.getBoundingClientRect();return Math.abs(i.clientX-(R+w)/2)}else{const{top:R,bottom:w}=b.getBoundingClientRect();return Math.abs(i.clientY-(R+w)/2)}}),u=e[a.indexOf(Math.min(...a))],f=e.indexOf(u);return{thumb:u,index:f}},g=i=>{const e=T(n["data-melt-id"]),a=v(i);if(!(!a||!e)&&e.contains(i.target))if(i.preventDefault(),D.set(a),a.thumb.focus(),O.set(!0),s.orientation==="horizontal"){const{left:u,right:f}=e.getBoundingClientRect();c(i.clientX,a.index,u,f)}else{const{top:u,bottom:f}=e.getBoundingClientRect();c(i.clientY,a.index,u,f)}},t=()=>{O.set(!1)},d=i=>{if(!y(O))return;const e=T(n["data-melt-id"]),a=y(D);if(!(!e||!a))if(a.thumb.focus(),s.orientation==="horizontal"){const{left:u,right:f}=e.getBoundingClientRect();c(i.clientX,a.index,u,f)}else{const{top:u,bottom:f}=e.getBoundingClientRect();c(i.clientY,a.index,u,f)}};return document.addEventListener("pointerdown",g),document.addEventListener("pointerup",t),document.addEventListener("pointerleave",t),document.addEventListener("pointermove",d),()=>{document.removeEventListener("pointerdown",g),document.removeEventListener("pointerup",t),document.removeEventListener("pointerleave",t),document.removeEventListener("pointermove",d)}}),{root:M,slider:M,range:I,thumb:P,value:E,options:p}};export{Q as c};
