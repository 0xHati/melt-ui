import{a as d,i as v}from"./index.a1398546.js";import{b as a,e as p,c as F,n as S}from"./callbacks.6723c42c.js";import{g as f,u as T,r as C,s as _,c as B}from"./portal.080fdab2.js";import{s as H}from"./style.928edf99.js";import{w as b}from"./index.cb808db3.js";import{D as I}from"./scheduler.2943ef39.js";const{name:i}=F("dialog"),L={preventScroll:!0,closeOnEscape:!0,closeOnOutsideClick:!0,role:"dialog"};function K(g={}){const h={...L,...g},c=b({...h}),m=b(null),n={content:f(),title:f(),description:f()},t=b(!1),k=a(i("trigger"),{stores:t,returned:e=>({"aria-haspopup":"dialog","aria-expanded":e,"aria-controls":n.content,type:"button"}),action:e=>({destroy:d(e,"click",r=>{const o=r.currentTarget;t.set(!0),m.set(o)})})}),O=a(i("overlay"),{stores:[t],returned:([e])=>({hidden:e?void 0:!0,tabindex:-1,style:H({display:e?void 0:"none"}),"aria-hidden":!0,"data-state":e?"open":"closed"})}),w=a(i("content"),{stores:t,returned:e=>({id:n.content,role:"dialog","aria-describedby":n.description,"aria-labelledby":n.title,"data-state":e?"open":"closed",tabindex:-1,hidden:e?void 0:!0}),action:e=>{let s=S;const{useFocusTrap:r,activate:o,deactivate:y}=B({immediate:!1,escapeDeactivates:!1,allowOutsideClick:u=>(u.preventDefault(),I(c).closeOnOutsideClick&&t.set(!1),!1),returnFocusOnDeactivate:!1,fallbackFocus:e}),l=r(e);return l&&l.destroy?s=l.destroy:s=y,p([t],([u])=>{e.hidden||!u?y():o()}),{destroy:s}}}),D=a(i("title"),{returned:()=>({id:n.title})}),E=a(i("description"),{returned:()=>({id:n.description})}),x=a(i("close"),{returned:()=>({type:"button"}),action:e=>({destroy:d(e,"click",()=>{t.set(!1)})})});return p([t,c],([e,s])=>{const r=[];return s.closeOnEscape&&e&&r.push(d(document,"keydown",o=>{o.key==="Escape"&&t.set(!1)})),s.preventScroll&&e&&r.push(C()),()=>{r.forEach(o=>o())}}),p([t,m],([e,s])=>{v&&!e&&s&&v&&_(1).then(()=>s.focus())}),{options:c,open:t,trigger:k,overlay:O,portal:T,content:w,title:D,description:E,close:x}}export{K as c};
